apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

bases:
  - ../../base

namePrefix: dev-

commonLabels:
  environment: development

# Patches for development environment
patchesStrategicMerge:
  - replica-count.yaml
  - resource-limits.yaml

# Update ConfigMap for development
configMapGenerator:
  - name: cloudbill-common-config
    namespace: cloudbill
    behavior: merge
    literals:
      - NODE_ENV=development
      - LOG_LEVEL=debug

# Use staging Let's Encrypt
patchesJson6902:
  - target:
      kind: Ingress
      name: cloudbill-ingress
    patch: |-
      - op: replace
        path: /metadata/annotations/cert-manager.io~1cluster-issuer
        value: letsencrypt-staging
